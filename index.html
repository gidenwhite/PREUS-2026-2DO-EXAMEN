<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PREUS 2026 - Banco de Preguntas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #1e40af;
            --primary-blue-light: #3b82f6;
            --primary-blue-dark: #1e3a8a;
            --accent-red: #e11d48;
            --accent-red-light: #f43f5e;
            --accent-red-dark: #be123c;
            --success: #059669;
            --success-light: #10b981;
            --warning: #f59e0b;
            --neutral-50: #f8fafc;
            --neutral-100: #f1f5f9;
            --neutral-200: #e2e8f0;
            --neutral-300: #cbd5e1;
            --neutral-600: #475569;
            --neutral-700: #334155;
            --neutral-900: #0f172a;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
            --radius: 12px;
            --radius-sm: 8px;
            --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-user-select: none;
            user-select: none;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(to br, var(--neutral-50), var(--neutral-100));
            color: var(--neutral-900);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: white;
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--neutral-200);
        }

        .header-content {
            max-width: 1280px;
            margin: 0 auto;
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1.5rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-blue-light));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
            box-shadow: var(--shadow-md);
        }

        .logo-text h1 {
            font-size: 1.25rem;
            font-weight: 800;
            color: var(--neutral-900);
            letter-spacing: -0.02em;
        }

        .logo-text p {
            font-size: 0.75rem;
            color: var(--neutral-600);
            font-weight: 500;
        }

        .header-actions {
            display: flex;
            gap: 0.75rem;
        }

        /* Container */
        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        /* Auth Card */
        .auth-card {
            background: white;
            border-radius: var(--radius);
            padding: 2rem;
            box-shadow: var(--shadow-md);
            margin-bottom: 2rem;
            border: 1px solid var(--neutral-200);
        }

        .auth-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--neutral-100);
        }

        .auth-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary-blue-light), var(--primary-blue));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
        }

        .auth-title h2 {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--neutral-900);
        }

        .auth-title p {
            font-size: 0.875rem;
            color: var(--neutral-600);
            margin-top: 0.25rem;
        }

        .auth-form {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .input-group {
            position: relative;
        }

        .input-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--neutral-600);
            font-size: 1rem;
        }

        .input {
            width: 100%;
            padding: 0.875rem 1rem 0.875rem 2.75rem;
            border: 2px solid var(--neutral-200);
            border-radius: var(--radius-sm);
            font-size: 0.9375rem;
            font-weight: 500;
            transition: var(--transition);
            background: var(--neutral-50);
        }

        .input:focus {
            outline: none;
            border-color: var(--primary-blue);
            background: white;
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .btn {
            padding: 0.875rem 1.5rem;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 0.9375rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            white-space: nowrap;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-blue-light));
            color: white;
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--accent-red), var(--accent-red-light));
            color: white;
            box-shadow: var(--shadow-md);
        }

        .btn-danger:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn-success {
            background: linear-gradient(135deg, #059669, var(--success-light));
            color: white;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
        }

        .btn-success::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn-success:hover::before {
            left: 100%;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .btn-block {
            width: 100%;
        }

        /* Alert */
        .alert {
            padding: 1rem 1.25rem;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.9375rem;
            font-weight: 500;
            margin-top: 1rem;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .alert-error {
            background: #fef2f2;
            color: var(--accent-red-dark);
            border: 1px solid #fecaca;
        }

        .alert-success {
            background: #f0fdf4;
            color: #166534;
            border: 1px solid #bbf7d0;
        }

        /* Subject Grid */
        .section-header {
            margin-bottom: 1.5rem;
        }

        .section-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--neutral-900);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.5rem;
        }

        .section-header p {
            color: var(--neutral-600);
            font-size: 0.9375rem;
        }

        .subject-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .subject-card {
            background: white;
            border: 2px solid var(--neutral-200);
            border-radius: var(--radius);
            padding: 1.5rem 1rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .subject-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-blue), var(--primary-blue-light));
            transform: scaleX(0);
            transition: var(--transition);
        }

        .subject-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-blue-light);
        }

        .subject-card:hover::before {
            transform: scaleX(1);
        }

        .subject-card.active {
            border-color: var(--primary-blue);
            background: linear-gradient(to bottom, #eff6ff, white);
            box-shadow: var(--shadow-md);
        }

        .subject-card.active::before {
            transform: scaleX(1);
        }

        .subject-icon {
            width: 56px;
            height: 56px;
            margin: 0 auto 1rem;
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-blue);
            font-size: 1.5rem;
            transition: var(--transition);
        }

        .subject-card:hover .subject-icon,
        .subject-card.active .subject-icon {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-blue-light));
            color: white;
            transform: scale(1.05);
        }

        .subject-name {
            font-weight: 700;
            font-size: 0.9375rem;
            color: var(--neutral-900);
        }

        /* Stats Bar */
        .stats-bar {
            background: white;
            border-radius: var(--radius);
            padding: 1.25rem 1.5rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--neutral-200);
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-blue);
        }

        .stat-content h3 {
            font-size: 0.875rem;
            color: var(--neutral-600);
            font-weight: 500;
        }

        .stat-content p {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--neutral-900);
        }

        .stat-value {
            color: var(--primary-blue);
        }

        /* Question Card */
        .question-card {
            background: white;
            border-radius: var(--radius);
            padding: 2rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--neutral-200);
            margin-bottom: 1.5rem;
            transition: var(--transition);
        }

        .question-card:hover {
            box-shadow: var(--shadow-lg);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--neutral-100);
        }

        .question-number {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-blue-light));
            color: white;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-sm);
            font-weight: 700;
            font-size: 0.9375rem;
        }

        .question-tag {
            background: var(--neutral-100);
            color: var(--neutral-700);
            padding: 0.375rem 0.875rem;
            border-radius: 20px;
            font-size: 0.8125rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        .question-text {
            font-size: 1.0625rem;
            line-height: 1.7;
            color: var(--neutral-900);
            margin-bottom: 1.5rem;
            font-weight: 500;
        }

        .options-grid {
            display: grid;
            gap: 0.875rem;
            margin-bottom: 1.5rem;
        }

        .option {
            padding: 1rem 1.25rem;
            border: 2px solid var(--neutral-200);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 1rem;
            background: var(--neutral-50);
        }

        .option:hover {
            border-color: var(--primary-blue-light);
            background: white;
            transform: translateX(2px);
        }

        .option.selected {
            border-color: var(--primary-blue);
            background: #eff6ff;
        }

        .option.correct {
            border-color: var(--success);
            background: #f0fdf4;
        }

        .option.incorrect {
            border-color: var(--accent-red);
            background: #fef2f2;
        }

        .option-letter {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border: 2px solid var(--neutral-300);
            color: var(--neutral-700);
            font-weight: 700;
            flex-shrink: 0;
            transition: var(--transition);
        }

        .option:hover .option-letter {
            border-color: var(--primary-blue-light);
            color: var(--primary-blue);
        }

        .option.selected .option-letter {
            background: var(--primary-blue);
            border-color: var(--primary-blue);
            color: white;
        }

        .option.correct .option-letter {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .option.incorrect .option-letter {
            background: var(--accent-red);
            border-color: var(--accent-red);
            color: white;
        }

        .option-text {
            flex: 1;
            font-weight: 500;
            color: var(--neutral-900);
        }

        .feedback {
            padding: 1rem 1.25rem;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 600;
            animation: slideIn 0.3s ease-out;
        }

        .feedback.correct {
            background: #f0fdf4;
            color: #166534;
            border: 2px solid #86efac;
        }

        .feedback.incorrect {
            background: #fef2f2;
            color: #991b1b;
            border: 2px solid #fca5a5;
        }

        .feedback i {
            font-size: 1.25rem;
        }

        /* Locked Content */
        .locked-overlay {
            background: white;
            border-radius: var(--radius);
            padding: 3rem 2rem;
            text-align: center;
            box-shadow: var(--shadow-xl);
            border: 2px solid var(--neutral-200);
            max-width: 600px;
            margin: 2rem auto;
        }

        .locked-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 1.5rem;
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent-red);
            font-size: 2rem;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(225, 29, 72, 0.4);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 0 0 15px rgba(225, 29, 72, 0);
            }
        }

        .locked-title {
            font-size: 1.75rem;
            font-weight: 800;
            color: var(--neutral-900);
            margin-bottom: 1rem;
        }

        .locked-text {
            color: var(--neutral-600);
            font-size: 1.0625rem;
            line-height: 1.7;
            margin-bottom: 2rem;
        }

        .price-tag {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            color: #92400e;
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius-sm);
            font-weight: 700;
            font-size: 1.125rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
            animation: shine 3s ease-in-out infinite;
        }

        @keyframes shine {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Badge de acceso */
        .access-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
        }

        .access-badge.limited {
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            color: var(--accent-red-dark);
            border: 2px solid var(--accent-red-light);
        }

        .access-badge.full {
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
            color: #065f46;
            border: 2px solid var(--success);
        }

        /* Destacados visuales */
        .highlight-box {
            background: linear-gradient(135deg, rgba(225, 29, 72, 0.05), rgba(244, 63, 94, 0.05));
            border: 2px solid var(--accent-red-light);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .highlight-box h3 {
            color: var(--accent-red);
            font-weight: 700;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .highlight-box ul {
            list-style: none;
            padding: 0;
        }

        .highlight-box li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            color: var(--neutral-700);
        }

        .highlight-box li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: var(--accent-red);
            font-weight: 700;
        }
        .footer {
            background: white;
            border-top: 1px solid var(--neutral-200);
            padding: 2rem 1.5rem;
            margin-top: 4rem;
        }

        .footer-content {
            max-width: 1280px;
            margin: 0 auto;
            text-align: center;
            color: var(--neutral-600);
            font-size: 0.875rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }

            .logo {
                justify-content: center;
            }

            .header-actions {
                flex-direction: column;
            }

            .auth-form {
                grid-template-columns: 1fr;
            }

            .subject-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .stats-bar {
                flex-direction: column;
                align-items: stretch;
            }

            .question-card {
                padding: 1.5rem;
            }

            .question-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.75rem;
            }
        }

        @media (max-width: 480px) {
            .subject-grid {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 1.5rem 1rem;
            }

            .auth-card {
                padding: 1.5rem;
            }

            .locked-overlay {
                padding: 2rem 1.5rem;
            }
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--neutral-600);
        }

        .spinner {
            width: 40px;
            height: 40px;
            margin: 0 auto 1rem;
            border: 4px solid var(--neutral-200);
            border-top-color: var(--primary-blue);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Watermark */
        .watermark {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            opacity: 0.03;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--neutral-900);
            overflow: hidden;
            display: none;
        }

        .watermark.active {
            display: block;
        }
    </style>
</head>
<body oncontextmenu="return false;">

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <div class="logo-text">
                    <h1>PREUS 2DO EXAMEN</h1>
                    <p>Banco de Preguntas ¬∑ Preus 2026</p>
                </div>
            </div>
            <div class="header-actions">
                <button class="btn btn-danger" id="logoutBtn" style="display:none;" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> Cerrar Sesi√≥n
                </button>
            </div>
        </div>
    </header>

    <!-- Watermark -->
    <div class="watermark" id="watermark"></div>

    <div class="container">
        <!-- Auth Section -->
        <div class="auth-card" id="authCard">
            <div class="auth-header">
                <div class="auth-icon">
                    <i class="fas fa-lock"></i>
                </div>
                <div class="auth-title">
                    <h2>Acceso Premium</h2>
                    <p>Ingresa tu c√≥digo para desbloquear todas las preguntas</p>
                </div>
            </div>
            
            <div class="auth-form">
                <div class="input-group">
                    <i class="fas fa-key input-icon"></i>
                    <input type="text" id="codeInput" class="input" placeholder="Ejemplo: BIO-8F3K" maxlength="20">
                </div>
                <button onclick="validateCode()" class="btn btn-primary">
                    <i class="fas fa-unlock"></i> Comprobar C√≥digo
                </button>
            </div>
            
            <button onclick="openWhatsAppAccess()" class="btn btn-success btn-block">
                <i class="fab fa-whatsapp"></i> Ver todas las Preguntas
            </button>
            
            <div id="authMessage"></div>
        </div>

        <!-- Subject Selection -->
        <div class="section-header">
            <h2><i class="fas fa-book-open"></i> Selecciona una Materia</h2>
            <p>Haz clic en cualquier materia para comenzar a practicar</p>
        </div>

        <div class="subject-grid">
            <div class="subject-card" onclick="loadSubject('lenguaje', this)">
                <div class="subject-icon">
                    <i class="fas fa-book"></i>
                </div>
                <h3 class="subject-name">Lenguaje</h3>
            </div>
            
            <div class="subject-card" onclick="loadSubject('social', this)">
                <div class="subject-icon">
                    <i class="fas fa-globe-americas"></i>
                </div>
                <h3 class="subject-name">Sociales</h3>
            </div>
            
            <div class="subject-card" onclick="loadSubject('matematica', this)">
                <div class="subject-icon">
                    <i class="fas fa-calculator"></i>
                </div>
                <h3 class="subject-name">Matem√°tica</h3>
            </div>
            
            <div class="subject-card" onclick="loadSubject('filosofia', this)">
                <div class="subject-icon">
                    <i class="fas fa-brain"></i>
                </div>
                <h3 class="subject-name">Filosof√≠a</h3>
            </div>
            
            <div class="subject-card" onclick="loadSubject('biologia', this)">
                <div class="subject-icon">
                    <i class="fas fa-dna"></i>
                </div>
                <h3 class="subject-name">Biolog√≠a</h3>
            </div>
            
            <div class="subject-card" onclick="loadSubject('quimica', this)">
                <div class="subject-icon">
                    <i class="fas fa-flask"></i>
                </div>
                <h3 class="subject-name">Qu√≠mica</h3>
            </div>
        </div>

        <!-- Stats Bar -->
        <div class="stats-bar" id="statsBar" style="display:none;">
            <div class="stat-item">
                <div class="stat-icon">
                    <i class="fas fa-book-open"></i>
                </div>
                <div class="stat-content">
                    <h3>Materia Actual</h3>
                    <p id="currentSubject">-</p>
                </div>
            </div>
            
            <div class="stat-item">
                <div class="stat-icon">
                    <i class="fas fa-list-ol"></i>
                </div>
                <div class="stat-content">
                    <h3>Preguntas Disponibles</h3>
                    <p><span class="stat-value" id="questionCount">0</span> preguntas</p>
                </div>
            </div>
            
            <div class="stat-item">
                <div class="stat-icon">
                    <i class="fas fa-info-circle"></i>
                </div>
                <div class="stat-content">
                    <h3>Estado</h3>
                    <p id="accessStatus">Acceso limitado</p>
                </div>
            </div>
        </div>

        <!-- Questions Container -->
        <div id="questionsContainer"></div>

        <!-- Locked Content -->
        <div id="lockedContent" style="display:none;">
            <div class="locked-overlay">
                <div class="locked-icon">
                    <i class="fas fa-lock"></i>
                </div>
                <h2 class="locked-title">üîí Contenido Premium Bloqueado</h2>
                <p class="locked-text">
                    Has alcanzado el l√≠mite de 15 preguntas gratuitas. Desbloquea el acceso completo para maximizar tu preparaci√≥n.
                </p>
                
                <div class="highlight-box">
                    <h3><i class="fas fa-star"></i> ¬øQu√© obtienes con el acceso premium?</h3>
                    <ul>
                        <li>Acceso ilimitado a TODAS las preguntas</li>
                        <li>Preguntas actualizadas del 2do examen PREUS 2026</li>
                        <li>Respuestas correctas al instante</li>
                        <li>Practica cuantas veces quieras</li>
                        <li>Un solo pago, acceso permanente</li>
                    </ul>
                </div>
                
                <div class="price-tag">
                    <i class="fas fa-tag"></i> Pago por QR
                </div>
                <button onclick="openWhatsAppAccess()" class="btn btn-success btn-block">
                    <i class="fab fa-whatsapp"></i> Obtener Mi C√≥digo Ahora
                </button>
                <p style="margin-top: 1rem; font-size: 0.875rem; color: var(--neutral-600);">
                    <i class="fas fa-shield-alt"></i> C√≥digo de uso personal ‚Ä¢ Un dispositivo ‚Ä¢ Acceso online
                </p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p>¬© 2026 Banco de Preguntas PREUS. Sistema de preparaci√≥n para ex√°menes universitarios.</p>
            <p style="margin-top: 0.5rem; font-size: 0.8125rem;">Desarrollado con tecnolog√≠a web moderna ¬∑ Protegido contra copia</p>
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, doc, getDoc, updateDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyAnqCepY0NoDbAVO3x7pADHmj9E3fl4t54",
            authDomain: "preus-2026-2do-examen.firebaseapp.com",
            projectId: "preus-2026-2do-examen",
            storageBucket: "preus-2026-2do-examen.firebasestorage.app",
            messagingSenderId: "348965754426",
            appId: "1:348965754426:web:928967e7ee80b49c2fc703"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        let currentSubject = null;
        let currentQuestions = [];
        let isAuthenticated = false;
        let userCode = localStorage.getItem('userCode') || null;
        let deviceId = localStorage.getItem('deviceId') || generateDeviceId();

        const whatsappLink = "https://wa.me/59162402261?text=Hola%20%F0%9F%91%8B%F0%9F%98%8A%0AQuiero%20adquirir%20mi%20c%C3%B3digo%20de%20acceso%20al%20banco%20de%20preguntas%20%F0%9F%93%9A%E2%9C%A8%0A%F0%9F%92%B0%20Precio%3A%2020%20Bs%20(pago%20por%20QR)%0A%F0%9F%94%90%20Entiendo%20que%20el%20c%C3%B3digo%20funciona%20solo%20en%20un%20dispositivo%2C%20es%20de%20uso%20personal%20y%20solo%20online%2C%20por%20lo%20que%20me%20comprometo%20a%20no%20compartirlo%20con%20nadie.%0A%C2%A1Quedo%20atento(a)%2C%20muchas%20gracias!%20%F0%9F%99%8C%F0%9F%93%B2";

        window.openWhatsAppAccess = function() {
            window.open(whatsappLink, '_blank');
        };

        function generateDeviceId() {
            const id = 'device_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            localStorage.setItem('deviceId', id);
            return id;
        }

        async function checkExistingSession() {
            if (userCode) {
                try {
                    const codeDoc = await getDoc(doc(db, 'codes', userCode));
                    if (codeDoc.exists()) {
                        const data = codeDoc.data();
                        if (data.deviceId === deviceId && data.sessionActive) {
                            isAuthenticated = true;
                            updateAuthUI(true);
                            return true;
                        }
                    }
                    localStorage.removeItem('userCode');
                    userCode = null;
                } catch (error) {
                    console.error("Error:", error);
                }
            }
            return false;
        }

        window.validateCode = async function() {
            const input = document.getElementById('codeInput').value.trim().toUpperCase();
            const msgDiv = document.getElementById('authMessage');
            
            if (!input) {
                msgDiv.innerHTML = '<div class="alert alert-error"><i class="fas fa-exclamation-circle"></i> Por favor ingresa un c√≥digo de acceso</div>';
                return;
            }

            try {
                const codeDoc = await getDoc(doc(db, 'codes', input));
                
                if (!codeDoc.exists()) {
                    msgDiv.innerHTML = '<div class="alert alert-error"><i class="fas fa-times-circle"></i> C√≥digo inv√°lido o no encontrado</div>';
                    return;
                }

                const data = codeDoc.data();

                if (data.sessionActive && data.deviceId !== deviceId) {
                    msgDiv.innerHTML = '<div class="alert alert-error"><i class="fas fa-exclamation-triangle"></i> Este c√≥digo ya est√° siendo usado en otro dispositivo</div>';
                    return;
                }

                await updateDoc(doc(db, 'codes', input), {
                    deviceId: deviceId,
                    sessionActive: true,
                    lastAccess: new Date().toISOString()
                });

                userCode = input;
                localStorage.setItem('userCode', input);
                isAuthenticated = true;
                updateAuthUI(true);
                msgDiv.innerHTML = '<div class="alert alert-success"><i class="fas fa-check-circle"></i> ¬°C√≥digo validado! Acceso completo desbloqueado</div>';
                
                if (currentSubject) {
                    renderQuestions();
                }
            } catch (error) {
                console.error("Error:", error);
                msgDiv.innerHTML = '<div class="alert alert-error"><i class="fas fa-times-circle"></i> Error al validar. Intenta nuevamente</div>';
            }
        };

        window.logout = async function() {
            if (userCode) {
                try {
                    await updateDoc(doc(db, 'codes', userCode), {
                        sessionActive: false
                    });
                } catch (error) {
                    console.error('Error:', error);
                }
                localStorage.removeItem('userCode');
                userCode = null;
                isAuthenticated = false;
                updateAuthUI(false);
                document.getElementById('authMessage').innerHTML = '<div class="alert alert-success"><i class="fas fa-sign-out-alt"></i> Sesi√≥n cerrada correctamente</div>';
                
                if (currentSubject) {
                    renderQuestions();
                }
            }
        };

        function updateAuthUI(authenticated) {
            const authCard = document.getElementById('authCard');
            const logoutBtn = document.getElementById('logoutBtn');
            const watermark = document.getElementById('watermark');

            if (authenticated) {
                authCard.style.display = 'none';
                logoutBtn.style.display = 'inline-flex';
                watermark.classList.add('active');
                
                let watermarkContent = '';
                for (let i = 0; i < 50; i++) {
                    watermarkContent += `${userCode}    `;
                }
                watermark.innerHTML = watermarkContent;
            } else {
                authCard.style.display = 'block';
                logoutBtn.style.display = 'none';
                watermark.classList.remove('active');
            }
        }

        window.loadSubject = function(subject, element) {
            currentSubject = subject;
            
            document.querySelectorAll('.subject-card').forEach(card => {
                card.classList.remove('active');
            });
            element.classList.add('active');
            
            const subjectNames = {
                'lenguaje': 'Lenguaje',
                'social': 'Ciencias Sociales',
                'matematica': 'Matem√°tica',
                'filosofia': 'Filosof√≠a',
                'biologia': 'Biolog√≠a',
                'quimica': 'Qu√≠mica'
            };
            
            document.getElementById('statsBar').style.display = 'flex';
            document.getElementById('currentSubject').textContent = subjectNames[subject];
            document.getElementById('questionsContainer').innerHTML = '<div class="loading"><div class="spinner"></div><p>Cargando preguntas...</p></div>';
            
            fetch(`${subject}.csv`)
                .then(response => {
                    if (!response.ok) throw new Error('Error');
                    return response.text();
                })
                .then(data => {
                    currentQuestions = parseCSV(data);
                    renderQuestions();
                })
                .catch(error => {
                    console.error("Error:", error);
                    document.getElementById('questionsContainer').innerHTML = 
                        '<div class="alert alert-error"><i class="fas fa-exclamation-triangle"></i> Error al cargar las preguntas</div>';
                });
        };

        function parseCSV(csv) {
            const lines = csv.split('\n').filter(line => line.trim());
            const questions = [];
            
            for (let i = 1; i < lines.length; i++) {
                const parts = lines[i].split(';');
                if (parts.length >= 7) {
                    questions.push({
                        number: parts[0].trim(),
                        question: parts[1].trim(),
                        a: parts[2].trim(),
                        b: parts[3].trim(),
                        c: parts[4].trim(),
                        d: parts[5].trim(),
                        correct: parts[6].trim().toUpperCase()
                    });
                }
            }
            return questions;
        }

        function renderQuestions() {
            const container = document.getElementById('questionsContainer');
            const lockedContent = document.getElementById('lockedContent');
            const questionCount = document.getElementById('questionCount');
            const accessStatus = document.getElementById('accessStatus');
            
            const limit = isAuthenticated ? currentQuestions.length : 15;
            const displayQuestions = currentQuestions.slice(0, limit);
            
            questionCount.textContent = displayQuestions.length;
            accessStatus.textContent = isAuthenticated ? '‚úì Acceso completo' : '‚ö† Limitado (15 preguntas)';
            
            let html = '';
            displayQuestions.forEach((q, index) => {
                html += `
                    <div class="question-card">
                        <div class="question-header">
                            <div class="question-number">Pregunta ${q.number}</div>
                            <div class="question-tag">${currentSubject.toUpperCase()}</div>
                        </div>
                        <div class="question-text">${q.question}</div>
                        <div class="options-grid">
                            <div class="option" onclick="selectOption(${index}, 'A')">
                                <div class="option-letter">A</div>
                                <div class="option-text">${q.a}</div>
                            </div>
                            <div class="option" onclick="selectOption(${index}, 'B')">
                                <div class="option-letter">B</div>
                                <div class="option-text">${q.b}</div>
                            </div>
                            <div class="option" onclick="selectOption(${index}, 'C')">
                                <div class="option-letter">C</div>
                                <div class="option-text">${q.c}</div>
                            </div>
                            <div class="option" onclick="selectOption(${index}, 'D')">
                                <div class="option-letter">D</div>
                                <div class="option-text">${q.d}</div>
                            </div>
                        </div>
                        <div id="feedback-${index}"></div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
            if (!isAuthenticated && currentQuestions.length > 15) {
                lockedContent.style.display = 'block';
            } else {
                lockedContent.style.display = 'none';
            }
        }

        window.selectOption = function(questionIndex, option) {
            const card = document.querySelectorAll('.question-card')[questionIndex];
            const options = card.querySelectorAll('.option');
            const feedbackDiv = document.getElementById(`feedback-${questionIndex}`);
            const correctAnswer = currentQuestions[questionIndex].correct;
            
            options.forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
                opt.style.pointerEvents = 'none';
            });
            
            const selectedOption = options[['A', 'B', 'C', 'D'].indexOf(option)];
            const correctOption = options[['A', 'B', 'C', 'D'].indexOf(correctAnswer)];
            
            correctOption.classList.add('correct');
            
            if (option === correctAnswer) {
                selectedOption.classList.add('selected');
                feedbackDiv.innerHTML = `
                    <div class="feedback correct">
                        <i class="fas fa-check-circle"></i>
                        <span><strong>¬°Excelente!</strong> Respuesta correcta: ${correctAnswer}</span>
                    </div>
                `;
            } else {
                selectedOption.classList.add('incorrect');
                feedbackDiv.innerHTML = `
                    <div class="feedback incorrect">
                        <i class="fas fa-times-circle"></i>
                        <span><strong>Incorrecto.</strong> La respuesta correcta es: ${correctAnswer}</span>
                    </div>
                `;
            }
            
            setTimeout(() => {
                options.forEach(opt => {
                    opt.style.pointerEvents = 'auto';
                });
            }, 2000);
        };

        checkExistingSession();
    </script>

    <script>
        function disableKeys(e) {
            if (e.ctrlKey && (e.key === 'p' || e.key === 'P' || e.key === 's' || e.key === 'S' || e.key === 'u' || e.key === 'U')) {
                e.preventDefault();
                return false;
            }
            if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
                e.preventDefault();
                return false;
            }
            return true;
        }

        document.addEventListener('copy', function(e) {
            e.preventDefault();
            return false;
        });

        document.addEventListener('cut', function(e) {
            e.preventDefault();
            return false;
        });

        window.addEventListener('beforeprint', function(e) {
            e.preventDefault();
            alert('La impresi√≥n est√° deshabilitada.');
            return false;
        });

        document.addEventListener('dragstart', function(e) {
            if (e.target.tagName === 'IMG') {
                e.preventDefault();
                return false;
            }
        });

        document.addEventListener('keydown', disableKeys);
    </script>
</body>
</html>
